// Copyright 2021 The Chromium Authors
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
const scriptPolicy=window.trustedTypes.createPolicy("webui-test-script",{createHTML:()=>"",createScriptURL:urlString=>{const url=new URL(urlString);if(url.protocol==="chrome:"){return urlString}console.error(`Invalid test URL ${urlString} found.`);return""},createScript:()=>""});export function loadTestModule(){const params=new URLSearchParams(window.location.search);const module=params.get("module");if(!module){return Promise.resolve(false)}const host=params.get("host")||"webui-test";if(host!=="test"&&host!=="webui-test"){return Promise.reject(new Error(`Invalid host=${host} parameter`))}return new Promise(((resolve,reject)=>{const script=document.createElement("script");script.type="module";const src=`chrome://${host}/${module}`;script.src=scriptPolicy.createScriptURL(src);script.onerror=function(){reject(new Error(`test_loader_util: Failed to load ${src}`))};script.onload=function(){resolve(true)};document.body.appendChild(script)}))}